<!doctype html>
<html>
<head>
    <meta charset="utf-8" />
    <title>登录-OrderERP</title>
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <link rel="stylesheet" type="text/css" href="/css/bootstrap.css" media="screen" />
    <script src="/js/jquery-1.12.3.min.js"></script>
    <script src="/js/jquery.form.js"></script>
    <script src="/js/bootstrap.min.js"></script>
    <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="/css/bower_components/html5shiv/dist/html5shiv.js"></script>
      <script src="/css/bower_components/respond/dest/respond.min.js"></script>
    <![endif]-->
</head>

<body style="padding-top:0px;">
<#assign security=JspTaglibs["/WEB-INF/security.tld"] />

<div class="container-fluid" style="padding:0px;">

    <div class="row" style="margin:0px;">
        <div class="col-sm-1 col-md-1 col-lg-1"></div>
        <div class="col-sm-10 col-md-10 col-lg-10">
            <div style="padding:22px 0px 22px 0px;">
                <h1 style="font-size:18px;">OrderERP</h1>
            </div>
        </div>
        <div class="col-sm-1 col-md-1 col-lg-1"></div>
        <div class="clearfix visible-xs-block"></div>
    </div>
    
    <div class="row" style="margin:0px;">
        <div class="col-sm-12 col-md-12 col-lg-12" style="height:600px; background-color:#ECECEC;">
        	<div class="col-sm-1 col-md-1 col-lg-1"></div>
            <div class="col-sm-10 col-md-10 col-lg-10">
            	<div class="row">
                	<div class="col-sm-6 col-md-6 col-lg-7">&nbsp;</div>
                	<div class="col-sm-5 col-md-5 col-lg-5">
                        <div style="margin:100px 10px 0px 10px; padding:20px 50px 20px 10px; background-color:#FFF;">
<form name="login_form" id="login_form" class="form-horizontal" role="form" method="post" action="/login">
    <div class="form-group">
        <label for="username" class="col-sm-3 col-md-3 col-lg-3 control-label">
        </label>
        <div class="col-sm-9">
            <h2 id="login-output">账户登录</h2>
        </div>
    </div>
    <div class="form-group">
        <label for="username" class="col-sm-3 control-label">
            帐号：
        </label>
        <div class="col-sm-9">
            <input type="text" class="form-control" id="username" name="username" />
        </div>
    </div>
    <div class="form-group">
        <label for="password" class="col-sm-3 control-label">
            密码：
        </label>
        <div class="col-sm-9">
            <input type="password" class="form-control" id="password" name="password" />
        </div>
    </div>
    <div class="form-group">
        <div class="col-sm-offset-3 col-sm-5">
            <div class="checkbox">
                <label>
                    <input type="checkbox" id="remember-me" name="remember-me" /> 记住帐号信息
                </label>
            </div>
        </div>
        <div class="col-sm-4">
            <div class="checkbox">
                <a href="/register">注册新用户</a>
            </div>
        </div>
    </div>
    <div class="form-group">
        <div class="col-sm-offset-3 col-sm-9">
            <input type="hidden" name="${_csrf.parameterName}" value="${_csrf.token}"/>
            <button type="submit" class="btn btn-default">
                登录系统
            </button>
        </div>
    </div>
</form>
<script type="text/javascript">
$(document).ready(function() {
    var options = {
        //target:        '#login-output',   // target element(s) to be updated with server response
        beforeSubmit:  showRequestLogin,  // pre-submit callback
        success:       showResponseLogin,  // post-submit callback
        // other available options:
        //url:       url         // override for form's 'action' attribute
        //type:      type        // 'get' or 'post', override for form's 'method' attribute
        //dataType:  json        // 'xml', 'script', or 'json' (expected server response type)
        //clearForm: true        // clear all form fields after successful submit
        //resetForm: true        // reset the form after successful submit
        // $.ajax options can be used here too, for example:
        //timeout:   3000
    };

    // bind form using 'ajaxForm'
    $('#login_form123').ajaxForm(options);
});

// pre-submit callback
function showRequestLogin(formData, jqForm, options) {
    // formData is an array; here we use $.param to convert it to a string to display it
    // but the form plugin does this for you automatically when it submits the data
    var queryString = $.param(formData);

    // jqForm is a jQuery object encapsulating the form element.  To access the
    // DOM element for the form do this:
    // var formElement = jqForm[0];

    //alert('About to submit: \n\n' + queryString);

    // here we could return false to prevent the form from being submitted;
    // returning anything other than false will allow the form submit to continue
    return true;
}

// post-submit callback
function showResponseLogin(responseText, statusText, xhr, $form)  {
    // for normal html responses, the first argument to the success callback
    // is the XMLHttpRequest object's responseText property

    // if the ajaxForm method was passed an Options Object with the dataType
    // property set to 'xml' then the first argument to the success callback
    // is the XMLHttpRequest object's responseXML property

    // if the ajaxForm method was passed an Options Object with the dataType
    // property set to 'json' then the first argument to the success callback
    // is the json data object returned by the server
	var response = responseText;
	if(!responseText.success){
		$("#login-output").html(response.message);
		alert(response.message);
	}else{
		$("#login-output").html(response.message);
		//alert(response.message);
		window.location.href=response.foward;
	}
}
</script>
                        </div>                    
                    </div>
                </div>
            </div>
            <div class="col-sm-1 col-md-1 col-lg-1"></div>
            <div class="clearfix visible-xs-block"></div>
        </div>
    </div>
</div>
    
</body>
</html>
